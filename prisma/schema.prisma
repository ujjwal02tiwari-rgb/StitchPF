
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("postgresql://postgres.dveyuxpxepobwcashnvl:Ujjwal18062002@aws-1-ap-south-1.pooler.supabase.com:5432/postgres?pgbouncer=true&connection_limit=1&sslmode=require")   // pooler (IPv4)
  directUrl = env("postgresql://postgres.dveyuxpxepobwcashnvl:Ujjwal18062002@aws-1-ap-south-1.pooler.supabase.com:5432/postgres")     // for migrations/introspection
}


model User {
  id        String    @id @default(cuid())
  handle    String    @unique
  name      String
  email     String?   @unique
  avatarB64 String?   // you currently store avatar in DB; keep for now
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  profiles  Profile[]
}

model Profile {
  id          String   @id @default(cuid())
  handle      String   @unique
  userId      String
  title       String
  bio         String
  theme       String    // "ocean" | "aurora" | "sunset" | "galaxy"
  accentHex   String    // e.g., "#22d3ee"
  cardSlug    String    @unique // /u/[cardSlug] share path
  published   Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  links       Link[]
}

model Link {
  id         String  @id @default(cuid())
  profileId  String
  label      String
  url        String

  profile    Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)
}
